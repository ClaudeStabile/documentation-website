"use strict";(self.webpackChunknewdoc=self.webpackChunknewdoc||[]).push([[372],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(n),h=o,m=d["".concat(l,".").concat(h)]||d[h]||u[h]||r;return n?a.createElement(m,i(i({ref:t},c),{},{components:n})):a.createElement(m,i({ref:t},c))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var p=2;p<r;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},1546:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>p});var a=n(7462),o=(n(7294),n(3905));const r={sidebar_position:1},i="HTTP authentication",s={unversionedId:"developpers/agent/clients/http/http",id:"developpers/agent/clients/http/http",title:"HTTP authentication",description:"LinTO clients communicate with different server API in order to obtain authentication and maintain a secure connexion with the services.",source:"@site/docs/developpers/agent/clients/http/http.md",sourceDirName:"developpers/agent/clients/http",slug:"/developpers/agent/clients/http/",permalink:"/docs/developpers/agent/clients/http/",draft:!1,editUrl:"https://github.com/linto-ai/documentation-website/tree/source/docs/developpers/agent/clients/http/http.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"devSidebar",previous:{title:"LinTO Clients",permalink:"/docs/developpers/agent/clients/"},next:{title:"MQTT operating protocol",permalink:"/docs/developpers/agent/clients/mqtt/"}},l={},p=[{value:"Authentication protocols",id:"authentication-protocols",level:2},{value:"1- Request authentication routes.",id:"1--request-authentication-routes",level:3},{value:"2- Request Authentication.",id:"2--request-authentication",level:3},{value:"3- Request applicative scopes.",id:"3--request-applicative-scopes",level:3},{value:"4- Logout",id:"4--logout",level:3}],c={toc:p};function u(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,a.Z)({},c,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"http-authentication"},"HTTP authentication"),(0,o.kt)("p",null,"LinTO clients communicate with different server API in order to obtain authentication and maintain a secure connexion with the services."),(0,o.kt)("p",null,"HTTP communication protocols (client-wise) focus on establishing a secure connexion between the client and the LinTO platform."),(0,o.kt)("p",null,"There are 2 categories of clients:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Clients configured to establish a direct MQTT connexion to the plateform (Raspberry or Android clients ",(0,o.kt)("strong",{parentName:"li"},"using serial number mode"),")"),(0,o.kt)("li",{parentName:"ul"},"Clients that request a connexion at every launch (Web or Android clients)")),(0,o.kt)("p",null,"On the former, the client is configured with all the informations needed to direcly subscribe and publish on the MQTT broker."),(0,o.kt)("p",null,"On the latest, the authentication is done with an additionnal first step that consist in requesting the connexion information to the authentication API."),(0,o.kt)("h2",{id:"authentication-protocols"},"Authentication protocols"),(0,o.kt)("p",null,"The goal of the authentication steps are to provide the client with the following informations:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"MQTT broker IP and port."),(0,o.kt)("li",{parentName:"ul"},"MQTT ID and password."),(0,o.kt)("li",{parentName:"ul"},"A session_ID."),(0,o.kt)("li",{parentName:"ul"},"An applicative scope."),(0,o.kt)("li",{parentName:"ul"},"A authentication token and a refresh token.")),(0,o.kt)("admonition",{title:"Ephemeral MQTT credentials",type:"note"},(0,o.kt)("p",{parentName:"admonition"},"After authentication, the LinTO server platform automagically sends ephemeral MQTT credentials to the HTTP authenticating client. When this client goes offline, the specific MQTT topics and credentials where this client was jailed into are destroyed.")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"client-server communication",src:n(5681).Z,width:"524",height:"252"})),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Prerequisites:")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The authentication server url: ",(0,o.kt)("inlineCode",{parentName:"li"},"server_url"),"."),(0,o.kt)("li",{parentName:"ul"},"Credentials: ",(0,o.kt)("inlineCode",{parentName:"li"},"username")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"password"),". ")),(0,o.kt)("h3",{id:"1--request-authentication-routes"},"1- Request authentication routes."),(0,o.kt)("p",null,"The first step ask the server about the authentication methodologies."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"type"),": GET"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"target API"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"server_url"),"/overwatch/auths"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"request format"),": "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'// Request header\n{\n    "Content-type" : "application/json",\n    "Accept" : "application/json"\n}\n')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"expected response"),": "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'// Code 200\n[\n    {"basePath" : "method_route" , "type" : "Method Name"}, //Authentication route\n    {"basePath" : "method_route2" , "type" : "Method2 Name"},\n    ...\n]\n')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"basePath")," is the path to used to access the authentication API. "),(0,o.kt)("h3",{id:"2--request-authentication"},"2- Request Authentication."),(0,o.kt)("p",null,"Once the authentication method is chosen, the client can request an authentication and fetch the connexion informations."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"type"),": POST"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"target API"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"server_url"),"/overwatch/",(0,o.kt)("inlineCode",{parentName:"p"},"basePath"),"/",(0,o.kt)("inlineCode",{parentName:"p"},"client-type"),"/login"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"client-type")," is the client platform, (e.g. android)."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"request format"),": "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'// Request header\n{\n    "Content-type" : "application/json",\n    "Accept" : "application/json",\n}\n// Request body\n\n{\n    "email" : "username",\n    "password" : "password"\n}\n\n')),(0,o.kt)("p",null,"If the credentials are accepted, the authentification server returns the information needed to establish a connexion between the client and the server using an MQTT broker."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"expected response"),": "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'// Code response 202\n// Body\n{\n  "user": {                                     // Authentication informations\n    "auth_token": "token",                      // Authentication token\n    "refresh_token": "refreshToken",            // Refresh token\n    "expiration_date": 1597498001,              // Token expiration date\n    "session_id": "session_id"                  // Session id used to identify the device\n  },\n  "mqtt": {                                     // MQTT information\n    "mqtt_host": "my-mqtt-test",                // Broker address\n    "mqtt_port": "1883",                        // Broker port\n    "mqtt_use_login": "true",                   // Is the broker using loggin\n    "mqtt_password": "password",                // Broker password\n    "mqtt_login": "user"                        // Broker login\n  }\n}\n')),(0,o.kt)("h3",{id:"3--request-applicative-scopes"},"3- Request applicative scopes."),(0,o.kt)("p",null,"The last remaining step is to ask the server about the applicative contexts available for this user."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"type"),": GET"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"target API"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"server_url"),"/overwatch/",(0,o.kt)("inlineCode",{parentName:"p"},"basePath"),"/scopes"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"request format"),": "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'// Request header\n{\n    "Content-type" : "application/json",\n    "Accept" : "application/json",\n    "Authorization" : "[client-type] [token]"\n}\n\n')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"expected response"),": "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'// Code response 200\n// Body\n[\n    {\n        "topic" : "topic",                          // Topic specific to the context\n        "name" : "Context name",                    // Context name for user\n        "description" : "Context description"       // Context description for user\n    },\n    {...}\n]\n\n')),(0,o.kt)("p",null,"Server might return multiple scopes for the user to use."),(0,o.kt)("p",null,"At the end of that step, the client has every information needed to establish a connexion and be fully functionnal."),(0,o.kt)("h3",{id:"4--logout"},"4- Logout"),(0,o.kt)("p",null,"When the client disconnect, it can call the logout API to revoke its token."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"type"),": GET"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"target API"),": ",(0,o.kt)("inlineCode",{parentName:"p"},"server_url"),"/overwatch/",(0,o.kt)("inlineCode",{parentName:"p"},"basePath"),"/",(0,o.kt)("inlineCode",{parentName:"p"},"platform"),"/logout"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"request format"),": "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'// Request header\n{\n    "Authorization" : "[client-type] [token]"\n}\n\n')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"expected response"),": "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},"// Code response 200\n// Body\nOK\n")),(0,o.kt)("p",null,"Once the client has fetched the connexion information it can connect to the ",(0,o.kt)("a",{parentName:"p",href:"client/mqtt_protocols"},"MQTT communication broker"),"."))}u.isMDXComponent=!0},5681:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/client-server-f7bcbd7ed172554b6950b34970ab76e1.png"}}]);