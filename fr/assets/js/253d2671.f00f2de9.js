"use strict";(self.webpackChunknewdoc=self.webpackChunknewdoc||[]).push([[2002],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>m});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),p=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},u=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=p(r),m=a,g=d["".concat(l,".").concat(m)]||d[m]||c[m]||o;return r?n.createElement(g,i(i({ref:t},u),{},{components:r})):n.createElement(g,i({ref:t},u))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var p=2;p<o;p++)i[p]=r[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},2895:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var n=r(7462),a=(r(7294),r(3905));const o={sidebar_position:2},i="OS Generator for LinTO on Raspberry Pi",s={unversionedId:"developpers/agent/clients/raspberry/osgenerator",id:"developpers/agent/clients/raspberry/osgenerator",title:"OS Generator for LinTO on Raspberry Pi",description:"Interactive generation / customization tools using ARM emulation in Chroot.",source:"@site/docs/developpers/agent/clients/raspberry/osgenerator.md",sourceDirName:"developpers/agent/clients/raspberry",slug:"/developpers/agent/clients/raspberry/osgenerator",permalink:"/fr/docs/developpers/agent/clients/raspberry/osgenerator",draft:!1,editUrl:"https://github.com/linto-ai/documentation-website/tree/source/docs/developpers/agent/clients/raspberry/osgenerator.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"devSidebar",previous:{title:"Raspberry prebuilt images",permalink:"/fr/docs/developpers/agent/clients/raspberry/download"},next:{title:"On device Wake-Word Spotting",permalink:"/fr/docs/developpers/agent/clients/raspberry/hotword"}},l={},p=[{value:"Prebuilt image",id:"prebuilt-image",level:3},{value:"Prerequisites of the host machine",id:"prerequisites-of-the-host-machine",level:2},{value:"ARM cross compilation",id:"arm-cross-compilation",level:3},{value:"Usage",id:"usage",level:2},{value:"Configuration",id:"configuration",level:3},{value:"LinTO Serial number and server address (pairing with LinTO platform)",id:"linto-serial-number-and-server-address-pairing-with-linto-platform",level:3},{value:"Soundcard",id:"soundcard",level:3},{value:"Raspberry LCD screen rotation",id:"raspberry-lcd-screen-rotation",level:3},{value:"Notes",id:"notes",level:2}],u={toc:p};function c(e){let{components:t,...o}=e;return(0,a.kt)("wrapper",(0,n.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"os-generator-for-linto-on-raspberry-pi"},"OS Generator for LinTO on Raspberry Pi"),(0,a.kt)("p",null,"Interactive generation / customization tools using ARM emulation in Chroot."),(0,a.kt)("p",null,"Get the tool here : ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/linto-ai/linto-os-generator"},"LinTO-OS-Generator")),(0,a.kt)("p",null,"This repository contains system configurations and parameters that can be used to build modular system images that runs directly on a Raspberry PI3, compute module3 or later boards."),(0,a.kt)("h3",{id:"prebuilt-image"},"Prebuilt image"),(0,a.kt)("p",null,"Configured user : pi"),(0,a.kt)("p",null,"Configured password : pi"),(0,a.kt)("p",null,"Link for this prebuilt image will come fast. Watch for it."),(0,a.kt)("p",null,"Usage of this prebuilt Raspberry Pi OS image documented in the ",(0,a.kt)("a",{parentName:"p",href:"client/quickstart"},"Quickstart")," tutorial"),(0,a.kt)("h2",{id:"prerequisites-of-the-host-machine"},"Prerequisites of the host machine"),(0,a.kt)("p",null,"In order to be able to manipulate ARM images directly on an AMD64 / x86_64 desktop computer, we use the qemu emulator. Thus the ARM binaries can be executed on the system running the ",(0,a.kt)("strong",{parentName:"p"},"generator.sh")," scripted tool.\nTo install qemu :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo apt-get install qemu-system-arm qemu-user-static kpartx\n")),(0,a.kt)("h3",{id:"arm-cross-compilation"},"ARM cross compilation"),(0,a.kt)("p",null,'You can use this tool to customize an existing ARM Linux image mounted as loopback device. Once "mounted and prepared" you can chroot into the image and work inside of it. You might want to apt-install some stuff using ARM apt repositories, you can also build and compile programs using ARM gcc... '),(0,a.kt)("h2",{id:"usage"},"Usage"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Tip")," You might follow these steps to customize some files in this repo before running the ",(0,a.kt)("strong",{parentName:"p"},"gnerator.sh")," script"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Wifi")),(0,a.kt)("p",null,"Put correct values for your network in :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"./wifi/root_part/etc/wpa_supplicant/wpa_supplicant.conf\n\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"SSH keys (useful for starting a ReverseSSH from your LinTO to any remote server), see contents in :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"./base/root_part/home/pi/.ssh/\n")),(0,a.kt)("p",null,"The LinTO private key shall be ./base/root_part/home/pi/.ssh/id_rsa with a chmod 600"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Start building your image using :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"./generator.sh <origin_image.img> <new_image.img> and follows the instructions\n")),(0,a.kt)("h3",{id:"configuration"},"Configuration"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Generator.sh",src:r(4876).Z,width:"1145",height:"627"})),(0,a.kt)("p",null,"To create a LinTO image, follow the next steps :"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Use 1 to copy the origin image to the new image"),(0,a.kt)("li",{parentName:"ul"},"Use 4 to mount and prepare partitions before Chroot"),(0,a.kt)("li",{parentName:"ul"},"Use 4.1 and 4.2 to install last raspbian packages"),(0,a.kt)("li",{parentName:"ul"},"Use 4.xx to automatically download and  install our latest distribution of binaries (see ",(0,a.kt)("a",{parentName:"li",href:"client/binaries"},"prebuilt binaries"),")"),(0,a.kt)("li",{parentName:"ul"},"Use 6 to enter chroot and manipulate the filesystem (insall custom packages, cross-compile ARM programs...)"),(0,a.kt)("li",{parentName:"ul"},"Use 7 to finalize the installation")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Tip")," At any point of the image building process, you can enter the chroot and manipulate freely anything your image being built."),(0,a.kt)("h3",{id:"linto-serial-number-and-server-address-pairing-with-linto-platform"},"LinTO Serial number and server address (pairing with LinTO platform)"),(0,a.kt)("p",null,'(You need to use "enter chroot" once "mount and prepare" is done in the generator script)'),(0,a.kt)("p",null,"Your LinTO needs an unique serial number to get recognized by the server stack. Once LinTO Client stack is installed while generating the OS, you need to edit the LinTO-Client config file in /home/pi/linto-client/terminal/linto.json and put the correct values (server address, serial number...)."),(0,a.kt)("p",null,"You're done !"),(0,a.kt)("p",null,"You can flash your SD card with this whole new image ! Don't forget to expand your filesystem on the target Raspberry Pi device."),(0,a.kt)("h3",{id:"soundcard"},"Soundcard"),(0,a.kt)("p",null,"You might use any USB soundcard (Jabra speak for instance)... or a platform specific sound-card like Seeed Respeaker Pi Hat modules. If you want to use this kind of sound-cards, LinTO won't start functional services,like GUI or keyword spotter, until the sound-card is properly attached to the system (install drivers first !)."),(0,a.kt)("p",null,"Raspberry Internal soundcard is disabled in our OS. It shall get enabled... but won't provide any sound input."),(0,a.kt)("p",null,"If no sound-card is installed, LinTO will boot to a console prompt (where you can install your soundcard driver). Use an external keyboard and CTRL+ALT+F1,F2,F3... to circle through local consoles."),(0,a.kt)("h3",{id:"raspberry-lcd-screen-rotation"},"Raspberry LCD screen rotation"),(0,a.kt)("p",null,"See : #lcd_rotate=2 in /boot/config.txt (inside chroot) or ./base/boot_part/config.txt before creating image."),(0,a.kt)("h2",{id:"notes"},"Notes"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://enavarro.me/emuler-un-raspberry-pi-avec-qemu.html"},"https://enavarro.me/emuler-un-raspberry-pi-avec-qemu.html")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.docker.com/engine/installation/linux/docker-ce/debian/#install-from-a-package"},"https://docs.docker.com/engine/installation/linux/docker-ce/debian/#install-from-a-package")),(0,a.kt)("li",{parentName:"ul"},"You can download the latest raspbian lite image here :  ",(0,a.kt)("a",{parentName:"li",href:"https://downloads.raspberrypi.org/raspbian_lite_latest"},"https://downloads.raspberrypi.org/raspbian_lite_latest"))))}c.isMDXComponent=!0},4876:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/generator-96260a785f1e1d60ab34169dd793bdfc.png"}}]);